import React, { Component } from 'react';
import { Link } from 'react-router-dom';
import PropTypes from 'prop-types';
import { connect } from 'react-redux';
import { logoutUser } from '../../actions/authActions';
import { clearCurrentProfile, getCurrentProfile } from '../../actions/profileActions';
import Dropdown from './Dropdown';
import { FaRegUserCircle } from 'react-icons/fa';
class Navbar extends Component {
	onLogout = (e) => {
		e.preventDefault();
		this.props.clearCurrentProfile();
		this.props.logoutUser();
		// redirect to login
		window.location.href = '/login';
	};

	componentDidMount() {
		if (this.props.auth.user.isAuthenticated) {
			this.props.getCurrentProfile();
		}
	}

	render() {
		const { isAuthenticated, user } = this.props.auth;
		const { profile } = this.props.profile;

		const privateLinks = (
			<React.Fragment>
				<Dropdown
					logout={this.onLogout}
					img={user.avatar}
					name={user.name}
					handle={profile ? profile.handle : ''}
				/>
			</React.Fragment>
		);

		const publicLinks = (
			<div className="auth-btn">
				<Link to="/register">
					<button className="btn btn-primary register">Create Account</button>
				</Link>
				<Link to="/login">
					<button className="btn btn-secondary login">
						<FaRegUserCircle />
						<span>Login</span>
					</button>
				</Link>
			</div>
		);

		return (
			<header className="header">
				<div className="container">
					<nav className="navbar">
						<Link to="/">
							<svg
								width="240"
								height="80"
								viewBox="0 0 923 249"
								fill="none"
								xmlns="http://www.w3.org/2000/svg"
							>
								<path
									d="M67.208 163.664C68.5307 163.995 69.192 164.656 69.192 165.648V168.128C69.192 169.12 68.0347 170.773 65.72 173.088C63.5707 175.403 61.1733 177.387 58.528 179.04C52.4107 183.339 46.4587 185.488 40.672 185.488C35.0507 185.488 30.1733 184.744 26.04 183.256C21.9067 181.603 18.2693 179.288 15.128 176.312C8.184 169.699 4.712 161.349 4.712 151.264C4.712 141.013 9.01067 131.755 17.608 123.488C26.3707 114.891 36.2907 110.592 47.368 110.592C55.1387 110.592 60.6773 111.584 63.984 113.568C66.1333 115.717 67.208 118.197 67.208 121.008C67.208 123.653 66.3813 126.133 64.728 128.448C63.0747 130.597 60.9253 131.672 58.28 131.672C55.6347 131.672 53.568 130.845 52.08 129.192C50.592 127.373 49.1867 125.72 47.864 124.232C44.888 120.925 41.168 119.272 36.704 119.272C33.3973 119.272 30.5867 121.752 28.272 126.712C26.288 131.011 25.296 136.053 25.296 141.84C25.296 147.627 26.04 152.421 27.528 156.224C29.016 160.027 30.9173 163.085 33.232 165.4C37.5307 169.699 42.408 171.848 47.864 171.848C53.32 171.848 57.4533 170.939 60.264 169.12C63.0747 167.301 65.3893 165.483 67.208 163.664ZM110.918 117.536C103.478 117.536 99.3447 123.653 98.518 135.888C98.1873 139.195 98.022 142.501 98.022 145.808C98.022 149.115 98.27 152.752 98.766 156.72C99.4273 160.523 100.502 163.995 101.99 167.136C105.131 174.576 109.347 178.296 114.638 178.296C122.409 178.296 126.79 172.261 127.782 160.192C127.947 157.051 128.03 153.827 128.03 150.52C128.03 147.213 127.699 143.576 127.038 139.608C126.377 135.64 125.302 132.085 123.814 128.944C120.673 121.339 116.374 117.536 110.918 117.536ZM112.902 110.84C118.523 110.84 123.649 111.749 128.278 113.568C133.073 115.387 137.206 117.949 140.678 121.256C147.787 128.2 151.342 136.88 151.342 147.296C151.342 157.547 147.622 166.475 140.182 174.08C133.073 181.52 124.062 185.24 113.15 185.24C101.742 185.24 92.4833 181.685 85.374 174.576C78.2647 167.467 74.71 158.787 74.71 148.536C74.71 138.451 78.3473 129.605 85.622 122C92.8967 114.56 101.99 110.84 112.902 110.84ZM206.726 181.272V178.544C206.726 177.883 206.478 177.717 205.982 178.048C205.486 178.379 204.577 178.957 203.254 179.784C201.931 180.611 200.361 181.437 198.542 182.264C190.11 186.067 182.257 186.149 174.982 182.512C167.542 179.04 162.251 173.088 159.11 164.656C157.457 160.523 156.63 155.563 156.63 149.776C156.63 143.824 158.118 138.368 161.094 133.408C164.235 128.283 168.038 124.067 172.502 120.76C176.966 117.453 181.595 115.056 186.39 113.568C191.35 111.915 195.649 111.088 199.286 111.088C202.923 111.088 205.155 111.171 205.982 111.336C206.478 111.336 206.726 110.096 206.726 107.616V92.736C206.726 89.264 206.395 86.6187 205.734 84.8C205.238 83.808 203.667 83.064 201.022 82.568C198.542 82.072 196.806 81.824 195.814 81.824C195.483 81.824 195.318 81.08 195.318 79.592C195.318 77.9387 195.483 76.9467 195.814 76.616C205.073 75.7893 212.595 74.5493 218.382 72.896C224.169 71.0773 227.227 70.2507 227.558 70.416C228.054 70.416 228.55 70.7467 229.046 71.408C229.542 72.0693 229.79 72.648 229.79 73.144C228.633 77.7733 228.054 83.2293 228.054 89.512V166.392C228.054 167.715 228.054 168.872 228.054 169.864C228.219 170.856 228.715 171.765 229.542 172.592C230.534 173.584 233.014 174.08 236.982 174.08C237.313 174.741 237.478 175.651 237.478 176.808C237.478 177.8 237.147 178.709 236.486 179.536C233.51 179.701 229.294 180.445 223.838 181.768C214.083 184.083 208.793 185.24 207.966 185.24C207.139 185.24 206.726 183.917 206.726 181.272ZM196.31 174.824C198.625 174.824 200.939 174.08 203.254 172.592C205.569 171.104 206.726 169.864 206.726 168.872V126.712C206.726 125.224 205.486 123.653 203.006 122C200.526 120.181 197.715 119.272 194.574 119.272C191.598 119.272 189.201 120.016 187.382 121.504C185.563 122.827 184.075 124.645 182.918 126.96C180.934 131.424 179.942 137.707 179.942 145.808C179.942 153.744 181.347 160.605 184.158 166.392C187.134 172.013 191.185 174.824 196.31 174.824ZM259.878 137.872C260.209 137.872 261.283 137.872 263.102 137.872C265.086 137.707 267.235 137.541 269.55 137.376C274.841 137.211 278.643 136.963 280.958 136.632C282.446 136.467 283.19 135.557 283.19 133.904C283.19 132.085 283.025 130.184 282.694 128.2C282.363 126.216 281.785 124.48 280.958 122.992C279.139 119.355 276.742 117.536 273.766 117.536C270.955 117.536 268.723 118.363 267.07 120.016C265.417 121.504 264.011 123.323 262.854 125.472C260.87 129.771 259.878 133.904 259.878 137.872ZM299.062 142.336C289.142 143.163 276.081 143.824 259.878 144.32C259.878 154.405 262.689 161.845 268.31 166.64C272.609 170.112 277.238 171.848 282.198 171.848C287.323 171.848 291.291 170.939 294.102 169.12C296.913 167.301 299.227 165.483 301.046 163.664C302.369 163.995 303.03 164.904 303.03 166.392C303.03 167.88 302.699 169.12 302.038 170.112C301.542 170.939 300.467 172.261 298.814 174.08C297.161 175.733 295.094 177.387 292.614 179.04C286.331 183.339 280.297 185.488 274.51 185.488C268.723 185.488 263.763 184.744 259.63 183.256C255.497 181.603 251.859 179.288 248.718 176.312C241.939 169.864 238.55 161.515 238.55 151.264C238.55 140.683 242.187 131.424 249.462 123.488C257.233 115.056 265.665 110.84 274.758 110.84C284.513 110.84 291.953 113.733 297.078 119.52C301.377 124.149 303.526 129.523 303.526 135.64C303.526 137.459 303.113 139.029 302.286 140.352C301.459 141.675 300.385 142.336 299.062 142.336ZM311.985 160.688C311.985 159.861 312.812 159.448 314.465 159.448C316.118 159.448 317.276 160.027 317.937 161.184C319.094 167.632 321.574 172.344 325.377 175.32C328.188 177.635 331.329 178.792 334.801 178.792C338.273 178.792 340.836 177.883 342.489 176.064C344.142 174.245 344.969 172.261 344.969 170.112C344.969 167.963 344.39 166.227 343.233 164.904C342.241 163.416 340.918 162.176 339.265 161.184C337.777 160.192 336.041 159.2 334.057 158.208C326.782 154.901 320.665 150.933 315.705 146.304C312.398 143.163 310.745 139.195 310.745 134.4C310.745 129.44 311.737 125.555 313.721 122.744C315.705 119.933 318.185 117.619 321.161 115.8C326.782 112.328 333.478 110.592 341.249 110.592C345.052 110.592 348.358 111.005 351.169 111.832C353.98 112.493 356.79 113.155 359.601 113.816C360.593 117.949 361.42 122.165 362.081 126.464C362.742 130.763 363.073 133.325 363.073 134.152C363.073 134.813 362.329 135.144 360.841 135.144C359.353 135.144 358.113 134.648 357.121 133.656C355.798 128.861 354.31 125.389 352.657 123.24C349.185 119.272 344.886 117.288 339.761 117.288C336.95 117.288 334.636 118.032 332.817 119.52C331.164 121.008 330.337 122.992 330.337 125.472C330.337 127.952 330.833 129.936 331.825 131.424C332.982 132.912 334.305 134.235 335.793 135.392C337.446 136.384 339.265 137.293 341.249 138.12C343.233 138.947 345.217 139.856 347.201 140.848C349.185 141.675 351.252 142.667 353.401 143.824C355.55 144.981 357.452 146.387 359.105 148.04C362.908 151.843 364.809 156.307 364.809 161.432C364.809 166.392 363.9 170.277 362.081 173.088C360.262 175.899 357.865 178.213 354.889 180.032C349.268 183.504 341.828 185.24 332.569 185.24C328.766 185.24 325.129 184.827 321.657 184C318.185 183.008 315.374 182.264 313.225 181.768C312.894 179.453 312.646 176.477 312.481 172.84C312.316 169.037 312.15 166.227 311.985 164.408C311.985 162.424 311.985 161.184 311.985 160.688ZM365.775 119.52C367.098 117.701 368.834 115.883 370.983 114.064H378.175V105.384C381.317 102.573 384.293 99.5973 387.103 96.456C390.079 93.3147 392.807 90.504 395.287 88.024C396.279 87.3627 397.189 87.1147 398.015 87.28C398.842 87.28 399.338 87.528 399.503 88.024V114.064H418.103C418.765 114.064 419.095 114.891 419.095 116.544C419.095 118.032 417.855 119.768 415.375 121.752H399.503V162.176C399.503 170.443 402.479 174.576 408.431 174.576C410.25 174.576 412.069 174.08 413.887 173.088C415.706 171.931 416.781 171.187 417.111 170.856C417.773 171.517 418.103 172.096 418.103 172.592C418.103 174.08 417.773 175.155 417.111 175.816C416.615 176.477 415.789 177.304 414.631 178.296C413.639 179.288 412.399 180.28 410.911 181.272C406.613 183.917 402.975 185.24 399.999 185.24C397.189 185.24 394.461 184.827 391.815 184C389.335 183.339 387.103 182.016 385.119 180.032C380.49 175.899 378.175 169.616 378.175 161.184V121.752H366.519C366.023 121.421 365.775 120.677 365.775 119.52ZM459.305 117.536C451.865 117.536 447.731 123.653 446.905 135.888C446.574 139.195 446.409 142.501 446.409 145.808C446.409 149.115 446.657 152.752 447.153 156.72C447.814 160.523 448.889 163.995 450.377 167.136C453.518 174.576 457.734 178.296 463.025 178.296C470.795 178.296 475.177 172.261 476.169 160.192C476.334 157.051 476.417 153.827 476.417 150.52C476.417 147.213 476.086 143.576 475.425 139.608C474.763 135.64 473.689 132.085 472.201 128.944C469.059 121.339 464.761 117.536 459.305 117.536ZM461.289 110.84C466.91 110.84 472.035 111.749 476.665 113.568C481.459 115.387 485.593 117.949 489.065 121.256C496.174 128.2 499.729 136.88 499.729 147.296C499.729 157.547 496.009 166.475 488.569 174.08C481.459 181.52 472.449 185.24 461.537 185.24C450.129 185.24 440.87 181.685 433.761 174.576C426.651 167.467 423.097 158.787 423.097 148.536C423.097 138.451 426.734 129.605 434.009 122C441.283 114.56 450.377 110.84 461.289 110.84ZM527.089 183.504C520.31 183.504 512.787 183.917 504.521 184.744C504.19 184.248 504.025 183.256 504.025 181.768C504.025 180.28 504.19 179.205 504.521 178.544C507.993 178.544 510.555 178.213 512.209 177.552C513.862 176.725 514.854 176.064 515.185 175.568C516.011 173.584 516.425 168.459 516.425 160.192V138.864C516.425 137.541 516.259 135.557 515.929 132.912C515.598 130.267 515.267 128.613 514.937 127.952C513.779 125.803 510.307 124.728 504.521 124.728C504.19 124.563 504.025 123.736 504.025 122.248C504.19 120.595 504.438 119.768 504.769 119.768C511.051 119.272 517.169 118.115 523.121 116.296C529.073 114.312 533.619 112.576 536.761 111.088C537.257 111.253 537.835 111.667 538.497 112.328C539.158 112.989 539.406 113.485 539.241 113.816C539.241 114.147 539.158 114.891 538.993 116.048C538.827 117.205 538.662 118.528 538.497 120.016C538.331 121.339 538.166 122.661 538.001 123.984C537.835 125.307 537.753 126.216 537.753 126.712C537.753 127.043 537.918 127.291 538.249 127.456C538.579 127.456 538.745 127.373 538.745 127.208C541.721 122.248 544.201 118.776 546.185 116.792C550.483 112.824 554.865 110.84 559.329 110.84C564.289 110.84 567.678 111.749 569.497 113.568C570.819 115.552 571.481 117.784 571.481 120.264C571.481 122.579 571.233 124.563 570.737 126.216C570.241 127.704 569.497 129.109 568.505 130.432C566.521 133.243 564.206 134.648 561.561 134.648C560.073 134.648 558.75 134.152 557.593 133.16C556.601 132.168 555.609 131.259 554.617 130.432C553.79 129.605 552.881 128.861 551.889 128.2C551.062 127.373 549.905 126.96 548.417 126.96C546.929 126.96 545.523 127.539 544.201 128.696C542.878 129.688 541.721 130.928 540.729 132.416C538.745 135.392 537.753 138.037 537.753 140.352V160.192C537.753 168.459 538.001 173.253 538.497 174.576C538.993 175.733 539.654 176.56 540.481 177.056C541.307 177.387 542.217 177.717 543.209 178.048C544.862 178.379 546.598 178.544 548.417 178.544C548.747 179.205 548.913 180.28 548.913 181.768C548.913 183.256 548.747 184.248 548.417 184.744C540.15 183.917 533.041 183.504 527.089 183.504ZM612.327 113.816C611.996 114.643 611.417 117.701 610.591 122.992V160.192C610.591 168.459 610.839 173.253 611.335 174.576C611.831 175.733 612.492 176.56 613.319 177.056C614.145 177.387 615.055 177.717 616.047 178.048C617.7 178.379 619.436 178.544 621.255 178.544C621.585 179.205 621.751 180.28 621.751 181.768C621.751 183.256 621.585 184.248 621.255 184.744C612.988 183.917 605.879 183.504 599.927 183.504C593.148 183.504 585.625 183.917 577.359 184.744C577.028 184.248 576.863 183.256 576.863 181.768C576.863 180.28 577.028 179.205 577.359 178.544C580.831 178.544 583.393 178.213 585.047 177.552C586.7 176.725 587.692 176.064 588.023 175.568C588.849 173.584 589.263 168.459 589.263 160.192V138.864C589.263 137.541 589.097 135.557 588.767 132.912C588.436 130.267 588.105 128.613 587.775 127.952C586.617 125.803 583.145 124.728 577.359 124.728C577.028 124.563 576.863 123.736 576.863 122.248C577.028 120.595 577.276 119.768 577.607 119.768C583.889 119.272 590.007 118.115 595.959 116.296C601.911 114.312 606.457 112.576 609.599 111.088C610.095 111.253 610.673 111.667 611.335 112.328C611.996 112.989 612.327 113.485 612.327 113.816ZM586.535 83.064C586.535 79.7573 587.609 77.0293 589.759 74.88C592.073 72.5653 594.884 71.408 598.191 71.408C601.497 71.408 604.308 72.5653 606.623 74.88C608.937 77.0293 610.095 79.7573 610.095 83.064C610.095 86.3707 608.937 89.1813 606.623 91.496C604.308 93.8107 601.497 94.968 598.191 94.968C594.884 94.968 592.073 93.8107 589.759 91.496C587.609 89.1813 586.535 86.3707 586.535 83.064ZM645.138 137.872C645.468 137.872 646.543 137.872 648.362 137.872C650.346 137.707 652.495 137.541 654.81 137.376C660.1 137.211 663.903 136.963 666.218 136.632C667.706 136.467 668.45 135.557 668.45 133.904C668.45 132.085 668.284 130.184 667.954 128.2C667.623 126.216 667.044 124.48 666.218 122.992C664.399 119.355 662.002 117.536 659.026 117.536C656.215 117.536 653.983 118.363 652.33 120.016C650.676 121.504 649.271 123.323 648.114 125.472C646.13 129.771 645.138 133.904 645.138 137.872ZM684.322 142.336C674.402 143.163 661.34 143.824 645.138 144.32C645.138 154.405 647.948 161.845 653.57 166.64C657.868 170.112 662.498 171.848 667.458 171.848C672.583 171.848 676.551 170.939 679.362 169.12C682.172 167.301 684.487 165.483 686.306 163.664C687.628 163.995 688.29 164.904 688.29 166.392C688.29 167.88 687.959 169.12 687.298 170.112C686.802 170.939 685.727 172.261 684.074 174.08C682.42 175.733 680.354 177.387 677.874 179.04C671.591 183.339 665.556 185.488 659.77 185.488C653.983 185.488 649.023 184.744 644.89 183.256C640.756 181.603 637.119 179.288 633.978 176.312C627.199 169.864 623.81 161.515 623.81 151.264C623.81 140.683 627.447 131.424 634.722 123.488C642.492 115.056 650.924 110.84 660.018 110.84C669.772 110.84 677.212 113.733 682.338 119.52C686.636 124.149 688.786 129.523 688.786 135.64C688.786 137.459 688.372 139.029 687.546 140.352C686.719 141.675 685.644 142.336 684.322 142.336ZM697.245 160.688C697.245 159.861 698.071 159.448 699.725 159.448C701.378 159.448 702.535 160.027 703.197 161.184C704.354 167.632 706.834 172.344 710.637 175.32C713.447 177.635 716.589 178.792 720.061 178.792C723.533 178.792 726.095 177.883 727.749 176.064C729.402 174.245 730.229 172.261 730.229 170.112C730.229 167.963 729.65 166.227 728.493 164.904C727.501 163.416 726.178 162.176 724.525 161.184C723.037 160.192 721.301 159.2 719.317 158.208C712.042 154.901 705.925 150.933 700.965 146.304C697.658 143.163 696.005 139.195 696.005 134.4C696.005 129.44 696.997 125.555 698.981 122.744C700.965 119.933 703.445 117.619 706.421 115.8C712.042 112.328 718.738 110.592 726.509 110.592C730.311 110.592 733.618 111.005 736.429 111.832C739.239 112.493 742.05 113.155 744.861 113.816C745.853 117.949 746.679 122.165 747.341 126.464C748.002 130.763 748.333 133.325 748.333 134.152C748.333 134.813 747.589 135.144 746.101 135.144C744.613 135.144 743.373 134.648 742.381 133.656C741.058 128.861 739.57 125.389 737.917 123.24C734.445 119.272 730.146 117.288 725.021 117.288C722.21 117.288 719.895 118.032 718.077 119.52C716.423 121.008 715.597 122.992 715.597 125.472C715.597 127.952 716.093 129.936 717.085 131.424C718.242 132.912 719.565 134.235 721.053 135.392C722.706 136.384 724.525 137.293 726.509 138.12C728.493 138.947 730.477 139.856 732.461 140.848C734.445 141.675 736.511 142.667 738.661 143.824C740.81 144.981 742.711 146.387 744.365 148.04C748.167 151.843 750.069 156.307 750.069 161.432C750.069 166.392 749.159 170.277 747.341 173.088C745.522 175.899 743.125 178.213 740.149 180.032C734.527 183.504 727.087 185.24 717.829 185.24C714.026 185.24 710.389 184.827 706.917 184C703.445 183.008 700.634 182.264 698.485 181.768C698.154 179.453 697.906 176.477 697.741 172.84C697.575 169.037 697.41 166.227 697.245 164.408C697.245 162.424 697.245 161.184 697.245 160.688ZM782.035 173.584C782.035 176.891 780.795 179.784 778.315 182.264C776 184.579 773.107 185.736 769.635 185.736C766.328 185.736 763.435 184.579 760.955 182.264C758.64 179.784 757.483 176.808 757.483 173.336C757.483 169.864 758.64 166.971 760.955 164.656C763.435 162.341 766.328 161.184 769.635 161.184C773.107 161.184 776 162.424 778.315 164.904C780.795 167.384 782.035 170.277 782.035 173.584Z"
									fill="#29023F"
								/>
								<rect x="779" y="76" width="144" height="68" rx="12" fill="#3037ED" />
								<circle cx="820" cy="110" r="11" fill="white" />
								<circle cx="850" cy="110" r="11" fill="white" />
								<circle cx="880" cy="110" r="11" fill="white" />
							</svg>
						</Link>

						<div>{isAuthenticated ? privateLinks : publicLinks}</div>
					</nav>
				</div>
			</header>
		);
	}
}

Navbar.propTypes = {
	logoutUser: PropTypes.func.isRequired,
	auth: PropTypes.object.isRequired
};

const mapStateToProps = (state) => ({
	auth: state.auth,
	profile: state.profile
});

export default connect(mapStateToProps, { logoutUser, clearCurrentProfile, getCurrentProfile })(Navbar);
